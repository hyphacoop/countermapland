import{a as st,v as H,d as J,o as Te,e as E,f as N,h as j,j as F,l as W,p as at,m as C,q as x,w as Se,x as lt,r as Ge,y as it,z as rt,A as Xe,n as Ue,B as ct,C as ut}from"../chunks/scheduler.8doqxhoJ.js";import{S as ft,i as mt,d as G,f as ze,v as dt,g as ee,h as te,b as R,j as b,c as we,e as k,m as ne,l as _e,t as _,a as M,k as ce,n as oe,o as ue,p as ht,q as _t}from"../chunks/index.B-UXCcAk.js";import{g as bt}from"../chunks/object-view.HoUL2Upa.js";import{b as He}from"../chunks/paths.hfhkfBMw.js";import{S as Je,T as Qe,L as pe,m as De,a as Me,f as $e,s as de,c as ke,b as ve,i as Be,d as re,e as qe,g as Ye,h as Ze,M as xe,j as et,B as tt,l as gt,k as nt,n as ot,p as Ne}from"../chunks/ToolsSidebar.EbrsaIh3.js";import{d as We,w as Fe}from"../chunks/index.XXZ5sPHA.js";const pt=!1,$t=Object.freeze(Object.defineProperty({__proto__:null,ssr:pt},Symbol.toStringTag,{value:"Module"})),{console:kt}=bt,L="src/routes/objects/+page.svelte";function Ae(s,t,e){const l=s.slice();return l[27]=t[e],l[29]=e,l}function ye(s){let t,e,l,a,n,i,f,v,K;function T(){return s[19](s[27])}const S={c:function(){t=E("div"),e=E("img"),this.h()},l:function(g){t=j(g,"DIV",{class:!0,key:!0,style:!0});var p=F(t);e=j(p,"IMG",{src:!0,alt:!0,style:!0,class:!0}),p.forEach(R),this.h()},h:function(){Se(e.src,l=s[27].challengesPower?`${s[27].photos[0].url}`:`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${s[27].photos[0].url}`)||b(e,"src",l),b(e,"alt",a=s[27].photos[0].alt),x(e,"cursor","pointer"),b(e,"class","s-BO-laqXqKOol"),C(e,L,220,8,7035),b(t,"class","image-container s-BO-laqXqKOol"),b(t,"key",s[29]),x(t,"top",he(s[29],s[1]).top+"px"),x(t,"left",he(s[29],s[1]).left+"px"),C(t,L,219,6,6875)},m:function(g,p){we(g,t,p),k(t,e),f=!0,v||(K=[_e(e,"click",ct(s[18]),!1,!1,!0,!1),_e(e,"click",T,!1,!1,!1,!1)],v=!0)},p:function(g,p){s=g,(!f||p&4&&!Se(e.src,l=s[27].challengesPower?`${s[27].photos[0].url}`:`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${s[27].photos[0].url}`))&&b(e,"src",l),(!f||p&4&&a!==(a=s[27].photos[0].alt))&&b(e,"alt",a),(!f||p&2)&&x(t,"top",he(s[29],s[1]).top+"px"),(!f||p&2)&&x(t,"left",he(s[29],s[1]).left+"px")},i:function(g){f||(g&&ut(()=>{f&&(i&&i.end(1),n=ht(e,$e,{duration:300}),n.start())}),f=!0)},o:function(g){n&&n.invalidate(),g&&(i=_t(e,$e,{duration:300})),f=!1},d:function(g){g&&R(t),g&&i&&i.end(),v=!1,Ge(K)}};return G("SvelteRegisterBlock",{block:S,id:ye.name,type:"if",source:"(219:4) {#if marker.photos && marker.photos.length > 0}",ctx:s}),S}function Ie(s){let t,e=s[27].photos&&s[27].photos.length>0&&ye(s);const l={c:function(){e&&e.c(),t=Xe()},l:function(n){e&&e.l(n),t=Xe()},m:function(n,i){e&&e.m(n,i),we(n,t,i)},p:function(n,i){n[27].photos&&n[27].photos.length>0?e?(e.p(n,i),i&4&&_(e,1)):(e=ye(n),e.c(),_(e,1),e.m(t.parentNode,t)):e&&(ue(),M(e,1,1,()=>{e=null}),ce())},d:function(n){n&&R(t),e&&e.d(n)}};return G("SvelteRegisterBlock",{block:l,id:Ie.name,type:"each",source:"(218:4) {#each populatedMarkers as marker, index}",ctx:s}),l}function Ve(s){let t,e;t=new Ye({$$inline:!0});const l={c:function(){ee(t.$$.fragment)},l:function(n){te(t.$$.fragment,n)},m:function(n,i){ne(t,n,i),e=!0},i:function(n){e||(_(t.$$.fragment,n),e=!0)},o:function(n){M(t.$$.fragment,n),e=!1},d:function(n){oe(t,n)}};return G("SvelteRegisterBlock",{block:l,id:Ve.name,type:"if",source:"(237:2) {#if $selectedMarkerId}",ctx:s}),l}function Ee(s){let t,e;t=new Ze({props:{objectView:!0},$$inline:!0}),t.$on("closeSideBar",s[16]);const l={c:function(){ee(t.$$.fragment)},l:function(n){te(t.$$.fragment,n)},m:function(n,i){ne(t,n,i),e=!0},p:Ue,i:function(n){e||(_(t.$$.fragment,n),e=!0)},o:function(n){M(t.$$.fragment,n),e=!1},d:function(n){oe(t,n)}};return G("SvelteRegisterBlock",{block:l,id:Ee.name,type:"if",source:"(240:2) {#if $currentSidebar === 'submissions'}",ctx:s}),l}function je(s){let t,e;t=new xe({$$inline:!0});const l={c:function(){ee(t.$$.fragment)},l:function(n){te(t.$$.fragment,n)},m:function(n,i){ne(t,n,i),e=!0},i:function(n){e||(_(t.$$.fragment,n),e=!0)},o:function(n){M(t.$$.fragment,n),e=!1},d:function(n){oe(t,n)}};return G("SvelteRegisterBlock",{block:l,id:je.name,type:"if",source:"(244:0) {#if $currentSidebar === 'menu'}",ctx:s}),l}function Ce(s){let t,e;t=new et({$$inline:!0});const l={c:function(){ee(t.$$.fragment)},l:function(n){te(t.$$.fragment,n)},m:function(n,i){ne(t,n,i),e=!0},i:function(n){e||(_(t.$$.fragment,n),e=!0)},o:function(n){M(t.$$.fragment,n),e=!1},d:function(n){oe(t,n)}};return G("SvelteRegisterBlock",{block:l,id:Ce.name,type:"if",source:"(248:0) {#if $currentSidebar === 'tools'}",ctx:s}),l}function Le(s){let t,e,l;e=new tt({$$inline:!0}),e.$on("openSubmissions",s[15]);const a={c:function(){t=E("div"),ee(e.$$.fragment),this.h()},l:function(i){t=j(i,"DIV",{class:!0});var f=F(t);te(e.$$.fragment,f),f.forEach(R),this.h()},h:function(){b(t,"class","banner-container s-BO-laqXqKOol"),C(t,L,261,2,8206)},m:function(i,f){we(i,t,f),ne(e,t,null),l=!0},p:Ue,i:function(i){l||(_(e.$$.fragment,i),l=!0)},o:function(i){M(e.$$.fragment,i),l=!1},d:function(i){i&&R(t),oe(e)}};return G("SvelteRegisterBlock",{block:a,id:Le.name,type:"if",source:"(261:0) {#if !$bannerClosed}",ctx:s}),a}function Re(s){let t,e,l,a,n,i,f,v,K="*countermap",T,S,B,g,p,y,A,X,se,I,z,D,ae,le,q,P,fe,ie,Q,me,be;l=new Je({$$inline:!0}),l.$on("updateView",s[10]),n=new Qe({props:{mapInstance:s[4],objectView:!0},$$inline:!0}),n.$on("zoom",s[8]);let U=ze(s[2]),w=[];for(let V=0;V<U.length;V+=1)w[V]=Ie(Ae(s,U,V));let o=s[5]&&Ve(s),r=s[3]==="submissions"&&Ee(s),c=s[3]==="menu"&&je(s),m=s[3]==="tools"&&Ce(s),d=!s[6]&&Le(s);const Y={c:function(){t=E("main"),e=E("div"),ee(l.$$.fragment),a=N(),ee(n.$$.fragment),i=N(),f=E("h1"),v=E("a"),v.textContent=K,T=N(),S=E("div");for(let u=0;u<w.length;u+=1)w[u].c();B=N(),g=E("div"),p=N(),o&&o.c(),y=N(),r&&r.c(),A=N(),c&&c.c(),X=N(),m&&m.c(),se=N(),I=E("div"),z=E("button"),D=E("img"),le=N(),q=E("button"),P=E("img"),ie=N(),d&&d.c(),this.h()},l:function(u){t=j(u,"MAIN",{class:!0});var O=F(t);e=j(O,"DIV",{class:!0});var h=F(e);te(l.$$.fragment,h),a=W(h),te(n.$$.fragment,h),i=W(h),f=j(h,"H1",{class:!0});var $=F(f);v=j($,"A",{href:!0,class:!0,"data-svelte-h":!0}),at(v)!=="svelte-hi9bqo"&&(v.textContent=K),$.forEach(R),T=W(h),S=j(h,"DIV",{class:!0});var Z=F(S);for(let Oe=0;Oe<w.length;Oe+=1)w[Oe].l(Z);B=W(Z),g=j(Z,"DIV",{id:!0,style:!0}),F(g).forEach(R),Z.forEach(R),p=W(h),o&&o.l(h),y=W(h),r&&r.l(h),A=W(h),c&&c.l(h),X=W(h),m&&m.l(h),h.forEach(R),se=W(O),I=j(O,"DIV",{class:!0});var ge=F(I);z=j(ge,"BUTTON",{class:!0});var Ke=F(z);D=j(Ke,"IMG",{src:!0,alt:!0,class:!0}),Ke.forEach(R),le=W(ge),q=j(ge,"BUTTON",{class:!0});var Pe=F(q);P=j(Pe,"IMG",{src:!0,style:!0,alt:!0,class:!0}),Pe.forEach(R),ge.forEach(R),ie=W(O),d&&d.l(O),O.forEach(R),this.h()},h:function(){b(v,"href",He+"/map"),b(v,"class","s-BO-laqXqKOol"),C(v,L,215,6,6702),b(f,"class","s-BO-laqXqKOol"),C(f,L,215,2,6698),b(g,"id","map"),x(g,"display","none"),C(g,L,234,4,7521),b(S,"class","image-grid s-BO-laqXqKOol"),C(S,L,216,2,6746),b(e,"class","content-container s-BO-laqXqKOol"),C(e,L,212,2,6533),Se(D.src,ae=nt)||b(D,"src",ae),b(D,"alt","Open Menu Sidebar"),b(D,"class","s-BO-laqXqKOol"),C(D,L,254,2,7958),b(z,"class","menu-button sdbbtn"),C(z,L,253,0,7900),Se(P.src,fe=ot)||b(P,"src",fe),x(P,"transform","rotate(90deg)"),b(P,"alt","Open Filter Sidebar"),b(P,"class","s-BO-laqXqKOol"),C(P,L,257,2,8079),b(q,"class","filter-button sdbbtn"),C(q,L,256,0,8018),b(I,"class","buttons-container s-BO-laqXqKOol"),C(I,L,252,0,7868),b(t,"class","s-BO-laqXqKOol"),C(t,L,211,0,6473)},m:function(u,O){we(u,t,O),k(t,e),ne(l,e,null),k(e,a),ne(n,e,null),k(e,i),k(e,f),k(f,v),k(e,T),k(e,S);for(let h=0;h<w.length;h+=1)w[h]&&w[h].m(S,null);k(S,B),k(S,g),k(e,p),o&&o.m(e,null),k(e,y),r&&r.m(e,null),k(e,A),c&&c.m(e,null),k(e,X),m&&m.m(e,null),k(t,se),k(t,I),k(I,z),k(z,D),k(I,le),k(I,q),k(q,P),k(t,ie),d&&d.m(t,null),s[20](t),Q=!0,me||(be=[_e(z,"click",s[13],!1,!1,!1,!1),_e(q,"click",s[14],!1,!1,!1,!1),_e(t,"click",s[12],!1,!1,!1,!1)],me=!0)},p:function(u,[O]){const h={};if(O&16&&(h.mapInstance=u[4]),n.$set(h),O&2054){U=ze(u[2]);let $;for($=0;$<U.length;$+=1){const Z=Ae(u,U,$);w[$]?w[$].p(Z,O):(w[$]=Ie(Z),w[$].c(),w[$].m(S,B))}for(;$<w.length;$+=1)w[$].d(1);w.length=U.length}u[5]?o?O&32&&_(o,1):(o=Ve(u),o.c(),_(o,1),o.m(e,y)):o&&(ue(),M(o,1,1,()=>{o=null}),ce()),u[3]==="submissions"?r?(r.p(u,O),O&8&&_(r,1)):(r=Ee(u),r.c(),_(r,1),r.m(e,A)):r&&(ue(),M(r,1,1,()=>{r=null}),ce()),u[3]==="menu"?c?O&8&&_(c,1):(c=je(u),c.c(),_(c,1),c.m(e,X)):c&&(ue(),M(c,1,1,()=>{c=null}),ce()),u[3]==="tools"?m?O&8&&_(m,1):(m=Ce(u),m.c(),_(m,1),m.m(e,null)):m&&(ue(),M(m,1,1,()=>{m=null}),ce()),u[6]?d&&(ue(),M(d,1,1,()=>{d=null}),ce()):d?(d.p(u,O),O&64&&_(d,1)):(d=Le(u),d.c(),_(d,1),d.m(t,null))},i:function(u){Q||(_(l.$$.fragment,u),_(n.$$.fragment,u),_(o),_(r),_(c),_(m),_(d),Q=!0)},o:function(u){M(l.$$.fragment,u),M(n.$$.fragment,u),M(o),M(r),M(c),M(m),M(d),Q=!1},d:function(u){u&&R(t),oe(l),oe(n),lt(w,u),o&&o.d(),r&&r.d(),c&&c.d(),m&&m.d(),d&&d.d(),s[20](null),me=!1,Ge(be)}};return G("SvelteRegisterBlock",{block:Y,id:Re.name,type:"component",source:"",ctx:s}),Y}function he(s,t){const e=s%3,l=75,a=50,n=4,i=Math.random()*75,f=Math.random()*75,v=Math.random()>.5?1:-1,K=Math.floor(t/(l+n+f)),T=Math.floor(e/K),S=e%K,B=e*(l+n),g=T*(a+n)+i*v,y=S*(l+n)+f*v+B;return{top:g,left:y}}function vt(s,t,e){let l,a,n,i,f,v,K,T,S;H(re,"currentSidebar"),J(s,re,o=>e(3,n=o)),H(ve,"mapInstanceStore"),J(s,ve,o=>e(4,f=o)),H(Be,"initialViewStore"),J(s,Be,o=>e(23,v=o)),H(ke,"currentViewStore"),J(s,ke,o=>e(24,K=o)),H(de,"selectedMarkerId"),J(s,de,o=>e(5,T=o)),H(qe,"bannerClosed"),J(s,qe,o=>e(6,S=o));let{$$slots:B={},$$scope:g}=t;dt("Page",B,[]);let p=Fe(8);H(p,"zoomLevel"),J(s,p,o=>e(22,i=o));let y,A,X;Te(()=>{y&&e(1,A=y.offsetWidth);let o;K&&console.log("current view store",K),o=v,!f&&(X=pe.map("map",{center:[o[0],o[1]],zoom:i}),ve.set(X),X.on("zoomend",()=>{p.set(X.getZoom())}))});function se(o){const{dir:r}=o.detail;p.update(c=>r==="in"?c<16?c+1:3:r==="out"?c>2?c-1:4:c)}const I=We([De,Me,p],([o,r,c])=>{if(!r||typeof r.contains!="function")return[];const m=o.filter(d=>{const[Y,V]=d.latLng;return r.contains(pe.latLng(Y,V))});for(let d=m.length-1;d>0;d--){const Y=Math.floor(Math.random()*(d+1));[m[d],m[Y]]=[m[Y],m[d]]}return m.slice(0,c)});H(I,"visibleRandomMarkers"),J(s,I,o=>e(17,a=o));function z(o,r){console.log("calculating bounds",o);const c=parseFloat(o[0]),m=parseFloat(o[1]);return pe.latLngBounds([c-r,m-r],[c+r,m+r])}function D(o){console.log("updating view");const{latLng:r}=o.detail,c=z(r,.1);Me.set(c),ke.set({lat:r[0],lng:r[1]})}function ae(o){de.set(o.id)}function le(o){console.log("main click"),!o.target.closest(".sdbbtn")&&!o.target.closest(".sidebar")&&!o.target.closest(".banner-container")&&(re.set(null),de.set(null))}function q(o){re.set(o)}function P(){q(n==="menu"?null:"menu")}function fe(){q(n==="tools"?null:"tools")}function ie(){q("submissions")}function Q(){console.log("closing sidebar"),re.set(null)}const me=[];Object.keys(t).forEach(o=>{!~me.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&kt.warn(`<Page> was created with unknown prop '${o}'`)});function be(o){it.call(this,s,o)}const U=o=>ae(o);function w(o){rt[o?"unshift":"push"](()=>{y=o,e(0,y)})}return s.$capture_state=()=>({onMount:Te,base:He,fade:$e,writable:Fe,derived:We,markersStore:De,mapBoundsStore:Me,selectedMarkerId:de,currentViewStore:ke,mapInstanceStore:ve,initialViewStore:Be,currentSidebar:re,bannerClosed:qe,Sidebar:Ye,SubmissionSidebar:Ze,Search:Je,Toolbar:Qe,MenuSidebar:xe,ToolsSidebar:et,Banner:tt,L:pe,latLngBounds:gt.latLngBounds,menuIconPath:nt,filterIconPath:ot,populatePhotos:Ne,zoomLevel:p,mainElement:y,mainWidth:A,map:X,getTransformation:he,updateZoom:se,visibleRandomMarkers:I,calculateBoundsFromSearch:z,handleUpdateView:D,handleImageClick:ae,handleMainClick:le,setCurrentSidebar:q,showMenu:P,showTools:fe,openSubmissions:ie,closeSidebar:Q,populatedMarkers:l,$visibleRandomMarkers:a,$currentSidebar:n,$zoomLevel:i,$mapInstanceStore:f,$initialViewStore:v,$currentViewStore:K,$selectedMarkerId:T,$bannerClosed:S}),s.$inject_state=o=>{"zoomLevel"in o&&e(7,p=o.zoomLevel),"mainElement"in o&&e(0,y=o.mainElement),"mainWidth"in o&&e(1,A=o.mainWidth),"map"in o&&(X=o.map),"populatedMarkers"in o&&e(2,l=o.populatedMarkers)},t&&"$$inject"in t&&s.$inject_state(t.$$inject),s.$$.update=()=>{s.$$.dirty&131072&&e(2,l=a.map(o=>({...o,photos:Ne(o)})))},[y,A,l,n,f,T,S,p,se,I,D,ae,le,P,fe,ie,Q,a,be,U,w]}class yt extends ft{constructor(t){super(t),mt(this,t,vt,Re,st,{}),G("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Re.name})}}export{yt as component,$t as universal};

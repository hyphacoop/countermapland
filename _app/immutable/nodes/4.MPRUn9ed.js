import{a as ot,v as J,d as Q,o as Xe,e as q,f as N,h as y,j as A,l as W,p as it,m as I,q as ae,w as Se,x as st,r as Ae,y as at,z as lt,A as ze,n as Ge,B as rt,C as ct}from"../chunks/scheduler.8doqxhoJ.js";import{S as ft,i as ut,d as G,f as De,v as mt,g as x,h as ee,b as E,j as p,c as we,e as v,m as te,l as be,t as g,a as O,k as le,n as ne,o as re,p as dt,q as bt}from"../chunks/index.B-UXCcAk.js";import{g as _t}from"../chunks/object-view.HoUL2Upa.js";import{b as Ue}from"../chunks/paths.2RcMe5YZ.js";import{S as He,T as Je,L as pe,m as Pe,a as $e,f as qe,s as me,c as ke,b as ve,i as Be,d as se,e as Me,g as Qe,h as Ye,M as Ze,j as xe,B as et,l as ht,k as tt,n as nt}from"../chunks/ToolsSidebar.P8swy2aO.js";import{d as Ne,w as We}from"../chunks/index.XXZ5sPHA.js";const gt=!1,Mt=Object.freeze(Object.defineProperty({__proto__:null,ssr:gt},Symbol.toStringTag,{value:"Module"})),{console:pt}=_t,V="src/routes/objects/+page.svelte";function Fe(i,t,e){const s=i.slice();return s[26]=t[e],s[28]=e,s}function ye(i){let t,e,s,a,n,l,m,S,R;function K(){return i[18](i[26])}const $={c:function(){t=q("div"),e=q("img"),this.h()},l:function(u){t=y(u,"DIV",{class:!0,key:!0,style:!0});var k=A(t);e=y(k,"IMG",{src:!0,alt:!0,style:!0,class:!0}),k.forEach(E),this.h()},h:function(){Se(e.src,s=`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${i[26].photos[0].url}`)||p(e,"src",s),p(e,"alt",a=i[26].photos[0].alt),ae(e,"cursor","pointer"),p(e,"class","s-BO-laqXqKOol"),I(e,V,214,8,6862),p(t,"class","image-container s-BO-laqXqKOol"),p(t,"key",i[28]),ae(t,"top",de(i[28],i[1]).top+"px"),ae(t,"left",de(i[28],i[1]).left+"px"),I(t,V,213,6,6702)},m:function(u,k){we(u,t,k),v(t,e),m=!0,S||(R=[be(e,"click",rt(i[17]),!1,!1,!0,!1),be(e,"click",K,!1,!1,!1,!1)],S=!0)},p:function(u,k){i=u,(!m||k&16&&!Se(e.src,s=`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${i[26].photos[0].url}`))&&p(e,"src",s),(!m||k&16&&a!==(a=i[26].photos[0].alt))&&p(e,"alt",a),(!m||k&2)&&ae(t,"top",de(i[28],i[1]).top+"px"),(!m||k&2)&&ae(t,"left",de(i[28],i[1]).left+"px")},i:function(u){m||(u&&ct(()=>{m&&(l&&l.end(1),n=dt(e,qe,{duration:300}),n.start())}),m=!0)},o:function(u){n&&n.invalidate(),u&&(l=bt(e,qe,{duration:300})),m=!1},d:function(u){u&&E(t),u&&l&&l.end(),S=!1,Ae(R)}};return G("SvelteRegisterBlock",{block:$,id:ye.name,type:"if",source:"(213:4) {#if marker.photos && marker.photos.length > 0}",ctx:i}),$}function Ie(i){let t,e=i[26].photos&&i[26].photos.length>0&&ye(i);const s={c:function(){e&&e.c(),t=ze()},l:function(n){e&&e.l(n),t=ze()},m:function(n,l){e&&e.m(n,l),we(n,t,l)},p:function(n,l){n[26].photos&&n[26].photos.length>0?e?(e.p(n,l),l&16&&g(e,1)):(e=ye(n),e.c(),g(e,1),e.m(t.parentNode,t)):e&&(re(),O(e,1,1,()=>{e=null}),le())},d:function(n){n&&E(t),e&&e.d(n)}};return G("SvelteRegisterBlock",{block:s,id:Ie.name,type:"each",source:"(212:4) {#each $visibleRandomMarkers as marker, index}",ctx:i}),s}function Ve(i){let t,e;t=new Qe({$$inline:!0});const s={c:function(){x(t.$$.fragment)},l:function(n){ee(t.$$.fragment,n)},m:function(n,l){te(t,n,l),e=!0},i:function(n){e||(g(t.$$.fragment,n),e=!0)},o:function(n){O(t.$$.fragment,n),e=!1},d:function(n){ne(t,n)}};return G("SvelteRegisterBlock",{block:s,id:Ve.name,type:"if",source:"(231:2) {#if $selectedMarkerId}",ctx:i}),s}function Ee(i){let t,e;t=new Ye({props:{objectView:!0},$$inline:!0}),t.$on("closeSideBar",i[16]);const s={c:function(){x(t.$$.fragment)},l:function(n){ee(t.$$.fragment,n)},m:function(n,l){te(t,n,l),e=!0},p:Ge,i:function(n){e||(g(t.$$.fragment,n),e=!0)},o:function(n){O(t.$$.fragment,n),e=!1},d:function(n){ne(t,n)}};return G("SvelteRegisterBlock",{block:s,id:Ee.name,type:"if",source:"(234:2) {#if $currentSidebar === 'submissions'}",ctx:i}),s}function Re(i){let t,e;t=new Ze({$$inline:!0});const s={c:function(){x(t.$$.fragment)},l:function(n){ee(t.$$.fragment,n)},m:function(n,l){te(t,n,l),e=!0},i:function(n){e||(g(t.$$.fragment,n),e=!0)},o:function(n){O(t.$$.fragment,n),e=!1},d:function(n){ne(t,n)}};return G("SvelteRegisterBlock",{block:s,id:Re.name,type:"if",source:"(238:0) {#if $currentSidebar === 'menu'}",ctx:i}),s}function je(i){let t,e;t=new xe({$$inline:!0});const s={c:function(){x(t.$$.fragment)},l:function(n){ee(t.$$.fragment,n)},m:function(n,l){te(t,n,l),e=!0},i:function(n){e||(g(t.$$.fragment,n),e=!0)},o:function(n){O(t.$$.fragment,n),e=!1},d:function(n){ne(t,n)}};return G("SvelteRegisterBlock",{block:s,id:je.name,type:"if",source:"(242:0) {#if $currentSidebar === 'tools'}",ctx:i}),s}function Ce(i){let t,e,s;e=new et({$$inline:!0}),e.$on("openSubmissions",i[15]);const a={c:function(){t=q("div"),x(e.$$.fragment),this.h()},l:function(l){t=y(l,"DIV",{class:!0});var m=A(t);ee(e.$$.fragment,m),m.forEach(E),this.h()},h:function(){p(t,"class","banner-container s-BO-laqXqKOol"),I(t,V,255,2,7947)},m:function(l,m){we(l,t,m),te(e,t,null),s=!0},p:Ge,i:function(l){s||(g(e.$$.fragment,l),s=!0)},o:function(l){O(e.$$.fragment,l),s=!1},d:function(l){l&&E(t),ne(e)}};return G("SvelteRegisterBlock",{block:a,id:Ce.name,type:"if",source:"(255:0) {#if !$bannerClosed}",ctx:i}),a}function Le(i){let t,e,s,a,n,l,m,S,R="*countermap",K,$,B,u,k,T,X,Y,U,j,z,C,ce,F,D,P,fe,oe,ie,ue,_e;s=new He({$$inline:!0}),s.$on("updateView",i[10]),n=new Je({props:{mapInstance:i[3],objectView:!0},$$inline:!0}),n.$on("zoom",i[8]);let H=De(i[4]),o=[];for(let L=0;L<H.length;L+=1)o[L]=Ie(Fe(i,H,L));let r=i[5]&&Ve(i),c=i[2]==="submissions"&&Ee(i),d=i[2]==="menu"&&Re(i),b=i[2]==="tools"&&je(i),_=!i[6]&&Ce(i);const he={c:function(){t=q("main"),e=q("div"),x(s.$$.fragment),a=N(),x(n.$$.fragment),l=N(),m=q("h1"),S=q("a"),S.textContent=R,K=N(),$=q("div");for(let f=0;f<o.length;f+=1)o[f].c();B=N(),u=q("div"),k=N(),r&&r.c(),T=N(),c&&c.c(),X=N(),d&&d.c(),Y=N(),b&&b.c(),U=N(),j=q("div"),z=q("button"),C=q("img"),F=N(),D=q("button"),P=q("img"),oe=N(),_&&_.c(),this.h()},l:function(f){t=y(f,"MAIN",{class:!0});var w=A(t);e=y(w,"DIV",{class:!0});var h=A(e);ee(s.$$.fragment,h),a=W(h),ee(n.$$.fragment,h),l=W(h),m=y(h,"H1",{class:!0});var M=A(m);S=y(M,"A",{href:!0,class:!0,"data-svelte-h":!0}),it(S)!=="svelte-hi9bqo"&&(S.textContent=R),M.forEach(E),K=W(h),$=y(h,"DIV",{class:!0});var Z=A($);for(let Oe=0;Oe<o.length;Oe+=1)o[Oe].l(Z);B=W(Z),u=y(Z,"DIV",{id:!0,style:!0}),A(u).forEach(E),Z.forEach(E),k=W(h),r&&r.l(h),T=W(h),c&&c.l(h),X=W(h),d&&d.l(h),Y=W(h),b&&b.l(h),h.forEach(E),U=W(w),j=y(w,"DIV",{class:!0});var ge=A(j);z=y(ge,"BUTTON",{class:!0});var Ke=A(z);C=y(Ke,"IMG",{src:!0,alt:!0,class:!0}),Ke.forEach(E),F=W(ge),D=y(ge,"BUTTON",{class:!0});var Te=A(D);P=y(Te,"IMG",{src:!0,alt:!0,class:!0}),Te.forEach(E),ge.forEach(E),oe=W(w),_&&_.l(w),w.forEach(E),this.h()},h:function(){p(S,"href",Ue+"/map"),p(S,"class","s-BO-laqXqKOol"),I(S,V,209,6,6524),p(m,"class","s-BO-laqXqKOol"),I(m,V,209,2,6520),p(u,"id","map"),ae(u,"display","none"),I(u,V,228,4,7295),p($,"class","image-grid s-BO-laqXqKOol"),I($,V,210,2,6568),p(e,"class","content-container s-BO-laqXqKOol"),I(e,V,206,2,6355),Se(C.src,ce=tt)||p(C,"src",ce),p(C,"alt","Open Menu Sidebar"),p(C,"class","s-BO-laqXqKOol"),I(C,V,248,2,7732),p(z,"class","menu-button sdbbtn"),I(z,V,247,0,7674),Se(P.src,fe=nt)||p(P,"src",fe),p(P,"alt","Open Filter Sidebar"),p(P,"class","s-BO-laqXqKOol"),I(P,V,251,2,7853),p(D,"class","filter-button sdbbtn"),I(D,V,250,0,7792),p(j,"class","buttons-container s-BO-laqXqKOol"),I(j,V,246,0,7642),p(t,"class","s-BO-laqXqKOol"),I(t,V,205,0,6295)},m:function(f,w){we(f,t,w),v(t,e),te(s,e,null),v(e,a),te(n,e,null),v(e,l),v(e,m),v(m,S),v(e,K),v(e,$);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m($,null);v($,B),v($,u),v(e,k),r&&r.m(e,null),v(e,T),c&&c.m(e,null),v(e,X),d&&d.m(e,null),v(e,Y),b&&b.m(e,null),v(t,U),v(t,j),v(j,z),v(z,C),v(j,F),v(j,D),v(D,P),v(t,oe),_&&_.m(t,null),i[19](t),ie=!0,ue||(_e=[be(z,"click",i[13],!1,!1,!1,!1),be(D,"click",i[14],!1,!1,!1,!1),be(t,"click",i[12],!1,!1,!1,!1)],ue=!0)},p:function(f,[w]){const h={};if(w&8&&(h.mapInstance=f[3]),n.$set(h),w&2066){H=De(f[4]);let M;for(M=0;M<H.length;M+=1){const Z=Fe(f,H,M);o[M]?o[M].p(Z,w):(o[M]=Ie(Z),o[M].c(),o[M].m($,B))}for(;M<o.length;M+=1)o[M].d(1);o.length=H.length}f[5]?r?w&32&&g(r,1):(r=Ve(f),r.c(),g(r,1),r.m(e,T)):r&&(re(),O(r,1,1,()=>{r=null}),le()),f[2]==="submissions"?c?(c.p(f,w),w&4&&g(c,1)):(c=Ee(f),c.c(),g(c,1),c.m(e,X)):c&&(re(),O(c,1,1,()=>{c=null}),le()),f[2]==="menu"?d?w&4&&g(d,1):(d=Re(f),d.c(),g(d,1),d.m(e,Y)):d&&(re(),O(d,1,1,()=>{d=null}),le()),f[2]==="tools"?b?w&4&&g(b,1):(b=je(f),b.c(),g(b,1),b.m(e,null)):b&&(re(),O(b,1,1,()=>{b=null}),le()),f[6]?_&&(re(),O(_,1,1,()=>{_=null}),le()):_?(_.p(f,w),w&64&&g(_,1)):(_=Ce(f),_.c(),g(_,1),_.m(t,null))},i:function(f){ie||(g(s.$$.fragment,f),g(n.$$.fragment,f),g(r),g(c),g(d),g(b),g(_),ie=!0)},o:function(f){O(s.$$.fragment,f),O(n.$$.fragment,f),O(r),O(c),O(d),O(b),O(_),ie=!1},d:function(f){f&&E(t),ne(s),ne(n),st(o,f),r&&r.d(),c&&c.d(),d&&d.d(),b&&b.d(),_&&_.d(),i[19](null),ue=!1,Ae(_e)}};return G("SvelteRegisterBlock",{block:he,id:Le.name,type:"component",source:"",ctx:i}),he}function de(i,t){const e=i%3,s=75,a=50,n=4,l=Math.random()*75,m=Math.random()*75,S=Math.random()>.5?1:-1,R=Math.floor(t/(s+n+m)),K=Math.floor(e/R),$=e%R,B=e*(s+n),u=K*(a+n)+l*S,T=$*(s+n)+m*S+B;return{top:u,left:T}}function kt(i,t,e){let s,a,n,l,m,S,R,K;J(se,"currentSidebar"),Q(i,se,o=>e(2,s=o)),J(ve,"mapInstanceStore"),Q(i,ve,o=>e(3,n=o)),J(Be,"initialViewStore"),Q(i,Be,o=>e(22,l=o)),J(ke,"currentViewStore"),Q(i,ke,o=>e(23,m=o)),J(me,"selectedMarkerId"),Q(i,me,o=>e(5,R=o)),J(Me,"bannerClosed"),Q(i,Me,o=>e(6,K=o));let{$$slots:$={},$$scope:B}=t;mt("Page",$,[]);let u=We(8);J(u,"zoomLevel"),Q(i,u,o=>e(21,a=o));let k,T,X;Xe(()=>{k&&e(1,T=k.offsetWidth);let o;m&&console.log("current view store",m),o=l,!n&&(X=pe.map("map",{center:[o[0],o[1]],zoom:a}),ve.set(X),X.on("zoomend",()=>{u.set(X.getZoom())}))});function Y(o){const{dir:r}=o.detail;u.update(c=>r==="in"?c<16?c+1:3:r==="out"?c>2?c-1:4:c)}const U=Ne([Pe,$e,u],([o,r,c])=>{if(!r||typeof r.contains!="function")return[];const d=o.filter(b=>{const[_,he]=b.latLng;return r.contains(pe.latLng(_,he))});for(let b=d.length-1;b>0;b--){const _=Math.floor(Math.random()*(b+1));[d[b],d[_]]=[d[_],d[b]]}return d.slice(0,c)});J(U,"visibleRandomMarkers"),Q(i,U,o=>e(4,S=o));function j(o,r){console.log("calculating bounds",o);const c=parseFloat(o[0]),d=parseFloat(o[1]);return pe.latLngBounds([c-r,d-r],[c+r,d+r])}function z(o){console.log("updating view");const{latLng:r}=o.detail,c=j(r,.1);$e.set(c),ke.set({lat:r[0],lng:r[1]})}function C(o){me.set(o.id)}function ce(o){console.log("main click"),!o.target.closest(".sdbbtn")&&!o.target.closest(".sidebar")&&!o.target.closest(".banner-container")&&(se.set(null),me.set(null))}function F(o){se.set(o)}function D(){F(s==="menu"?null:"menu")}function P(){F(s==="tools"?null:"tools")}function fe(){F("submissions")}function oe(){console.log("closing sidebar"),se.set(null)}const ie=[];Object.keys(t).forEach(o=>{!~ie.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&pt.warn(`<Page> was created with unknown prop '${o}'`)});function ue(o){at.call(this,i,o)}const _e=o=>C(o);function H(o){lt[o?"unshift":"push"](()=>{k=o,e(0,k)})}return i.$capture_state=()=>({onMount:Xe,base:Ue,fade:qe,writable:We,derived:Ne,markersStore:Pe,mapBoundsStore:$e,selectedMarkerId:me,currentViewStore:ke,mapInstanceStore:ve,initialViewStore:Be,currentSidebar:se,bannerClosed:Me,Sidebar:Qe,SubmissionSidebar:Ye,Search:He,Toolbar:Je,MenuSidebar:Ze,ToolsSidebar:xe,Banner:et,L:pe,latLngBounds:ht.latLngBounds,menuIconPath:tt,filterIconPath:nt,zoomLevel:u,mainElement:k,mainWidth:T,map:X,getTransformation:de,updateZoom:Y,visibleRandomMarkers:U,calculateBoundsFromSearch:j,handleUpdateView:z,handleImageClick:C,handleMainClick:ce,setCurrentSidebar:F,showMenu:D,showTools:P,openSubmissions:fe,closeSidebar:oe,$currentSidebar:s,$zoomLevel:a,$mapInstanceStore:n,$initialViewStore:l,$currentViewStore:m,$visibleRandomMarkers:S,$selectedMarkerId:R,$bannerClosed:K}),i.$inject_state=o=>{"zoomLevel"in o&&e(7,u=o.zoomLevel),"mainElement"in o&&e(0,k=o.mainElement),"mainWidth"in o&&e(1,T=o.mainWidth),"map"in o&&(X=o.map)},t&&"$$inject"in t&&i.$inject_state(t.$$inject),[k,T,s,n,S,R,K,u,Y,U,z,C,ce,D,P,fe,oe,ue,_e,H]}class qt extends ft{constructor(t){super(t),ut(this,t,kt,Le,ot,{}),G("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Le.name})}}export{qt as component,Mt as universal};

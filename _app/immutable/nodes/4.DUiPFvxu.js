import{a as Ce,v as N,d as H,o as Se,e as C,f as E,h as P,j as G,l as z,p as Pe,m as K,q as U,w as Ke,x as Xe,y as De,z as we,n as Te,A as $e,B as We,C as Ae,r as Fe}from"../chunks/scheduler.fofTsB6g.js";import{S as Ne,i as He,d as D,f as Me,v as Ge,g as J,h as Q,b as V,j as B,c as ve,e as O,m as Y,l as ue,t as k,a as y,k as ne,n as Z,o as oe,p as Ue,q as Je}from"../chunks/index.4nbd_kv8.js";import{g as Qe}from"../chunks/object-view.mo5FT0xg.js";import{b as Ie}from"../chunks/paths.bVcKHT-f.js";import{S as je,T as Le,L as ie,m as ye,a as ce,f as me,s as ee,c as se,b as re,i as fe,d as te,e as Re,g as Ve,M as Ee,h as ze,l as Ye,j as Ze,k as xe}from"../chunks/ToolsSidebar.5eN-l_eO.js";import{d as Oe,w as Be}from"../chunks/index.DwQbObdf.js";const et=!1,ct=Object.freeze(Object.defineProperty({__proto__:null,ssr:et},Symbol.toStringTag,{value:"Module"})),{console:tt}=Qe,X="src/routes/objects/+page.svelte";function qe(a,t,e){const s=a.slice();return s[20]=t[e],s[22]=e,s}function de(a){let t,e,s,i,n,l,m,b,q;function I(){return a[14](a[20])}const M={c:function(){t=C("div"),e=C("img"),this.h()},l:function(c){t=P(c,"DIV",{class:!0,key:!0,style:!0});var v=G(t);e=P(v,"IMG",{src:!0,alt:!0,style:!0,class:!0}),v.forEach(V),this.h()},h:function(){$e(e.src,s=`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${a[20].photos[0].url}`)||B(e,"src",s),B(e,"alt",i=a[20].photos[0].alt),U(e,"cursor","pointer"),B(e,"class","s-BO-laqXqKOol"),K(e,X,189,8,6301),B(t,"class","image-container s-BO-laqXqKOol"),B(t,"key",a[22]),U(t,"top",ae(a[22],a[1]).top+"px"),U(t,"left",ae(a[22],a[1]).left+"px"),K(t,X,188,6,6141)},m:function(c,v){ve(c,t,v),O(t,e),m=!0,b||(q=[ue(e,"click",We(a[13]),!1,!1,!0,!1),ue(e,"click",I,!1,!1,!1,!1)],b=!0)},p:function(c,v){a=c,(!m||v&8&&!$e(e.src,s=`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${a[20].photos[0].url}`))&&B(e,"src",s),(!m||v&8&&i!==(i=a[20].photos[0].alt))&&B(e,"alt",i),(!m||v&2)&&U(t,"top",ae(a[22],a[1]).top+"px"),(!m||v&2)&&U(t,"left",ae(a[22],a[1]).left+"px")},i:function(c){m||(c&&Ae(()=>{m&&(l&&l.end(1),n=Ue(e,me,{duration:300}),n.start())}),m=!0)},o:function(c){n&&n.invalidate(),c&&(l=Je(e,me,{duration:300})),m=!1},d:function(c){c&&V(t),c&&l&&l.end(),b=!1,Fe(q)}};return D("SvelteRegisterBlock",{block:M,id:de.name,type:"if",source:"(188:4) {#if marker.photos && marker.photos.length > 0}",ctx:a}),M}function _e(a){let t,e=a[20].photos&&a[20].photos.length>0&&de(a);const s={c:function(){e&&e.c(),t=we()},l:function(n){e&&e.l(n),t=we()},m:function(n,l){e&&e.m(n,l),ve(n,t,l)},p:function(n,l){n[20].photos&&n[20].photos.length>0?e?(e.p(n,l),l&8&&k(e,1)):(e=de(n),e.c(),k(e,1),e.m(t.parentNode,t)):e&&(oe(),y(e,1,1,()=>{e=null}),ne())},d:function(n){n&&V(t),e&&e.d(n)}};return D("SvelteRegisterBlock",{block:s,id:_e.name,type:"each",source:"(187:4) {#each $visibleRandomMarkers as marker, index}",ctx:a}),s}function he(a){let t,e;t=new Re({$$inline:!0});const s={c:function(){J(t.$$.fragment)},l:function(n){Q(t.$$.fragment,n)},m:function(n,l){Y(t,n,l),e=!0},i:function(n){e||(k(t.$$.fragment,n),e=!0)},o:function(n){y(t.$$.fragment,n),e=!1},d:function(n){Z(t,n)}};return D("SvelteRegisterBlock",{block:s,id:he.name,type:"if",source:"(206:2) {#if $selectedMarkerId}",ctx:a}),s}function ge(a){let t,e;t=new Ve({props:{objectView:!0},$$inline:!0}),t.$on("closeSideBar",a[12]);const s={c:function(){J(t.$$.fragment)},l:function(n){Q(t.$$.fragment,n)},m:function(n,l){Y(t,n,l),e=!0},p:Te,i:function(n){e||(k(t.$$.fragment,n),e=!0)},o:function(n){y(t.$$.fragment,n),e=!1},d:function(n){Z(t,n)}};return D("SvelteRegisterBlock",{block:s,id:ge.name,type:"if",source:"(209:2) {#if $currentSidebar === 'submissions'}",ctx:a}),s}function pe(a){let t,e;t=new Ee({$$inline:!0});const s={c:function(){J(t.$$.fragment)},l:function(n){Q(t.$$.fragment,n)},m:function(n,l){Y(t,n,l),e=!0},i:function(n){e||(k(t.$$.fragment,n),e=!0)},o:function(n){y(t.$$.fragment,n),e=!1},d:function(n){Z(t,n)}};return D("SvelteRegisterBlock",{block:s,id:pe.name,type:"if",source:"(213:0) {#if $currentSidebar === 'menu'}",ctx:a}),s}function be(a){let t,e;t=new ze({$$inline:!0});const s={c:function(){J(t.$$.fragment)},l:function(n){Q(t.$$.fragment,n)},m:function(n,l){Y(t,n,l),e=!0},i:function(n){e||(k(t.$$.fragment,n),e=!0)},o:function(n){y(t.$$.fragment,n),e=!1},d:function(n){Z(t,n)}};return D("SvelteRegisterBlock",{block:s,id:be.name,type:"if",source:"(217:0) {#if $currentSidebar === 'tools'}",ctx:a}),s}function ke(a){let t,e,s,i,n,l,m,b,q="*countermap",I,M,d,c,v,j,L,T,W,A,x;s=new je({$$inline:!0}),s.$on("updateView",a[9]),n=new Le({props:{mapInstance:a[2],objectView:!0},$$inline:!0}),n.$on("zoom",a[7]);let R=Me(a[3]),S=[];for(let u=0;u<R.length;u+=1)S[u]=_e(qe(a,R,u));let g=a[4]&&he(a),_=a[5]==="submissions"&&ge(a),p=a[5]==="menu"&&pe(a),o=a[5]==="tools"&&be(a);const w={c:function(){t=C("main"),e=C("div"),J(s.$$.fragment),i=E(),J(n.$$.fragment),l=E(),m=C("h1"),b=C("a"),b.textContent=q,I=E(),M=C("div");for(let r=0;r<S.length;r+=1)S[r].c();d=E(),c=C("div"),v=E(),g&&g.c(),j=E(),_&&_.c(),L=E(),p&&p.c(),T=E(),o&&o.c(),this.h()},l:function(r){t=P(r,"MAIN",{class:!0});var h=G(t);e=P(h,"DIV",{class:!0});var f=G(e);Q(s.$$.fragment,f),i=z(f),Q(n.$$.fragment,f),l=z(f),m=P(f,"H1",{class:!0});var $=G(m);b=P($,"A",{href:!0,class:!0,"data-svelte-h":!0}),Pe(b)!=="svelte-hi9bqo"&&(b.textContent=q),$.forEach(V),I=z(f),M=P(f,"DIV",{class:!0});var F=G(M);for(let le=0;le<S.length;le+=1)S[le].l(F);d=z(F),c=P(F,"DIV",{id:!0,style:!0}),G(c).forEach(V),F.forEach(V),v=z(f),g&&g.l(f),j=z(f),_&&_.l(f),L=z(f),p&&p.l(f),T=z(f),o&&o.l(f),f.forEach(V),h.forEach(V),this.h()},h:function(){B(b,"href",Ie+"/map"),B(b,"class","s-BO-laqXqKOol"),K(b,X,184,6,5963),B(m,"class","s-BO-laqXqKOol"),K(m,X,184,2,5959),B(c,"id","map"),U(c,"display","none"),K(c,X,203,4,6734),B(M,"class","image-grid s-BO-laqXqKOol"),K(M,X,185,2,6007),B(e,"class","content-container s-BO-laqXqKOol"),K(e,X,181,2,5794),B(t,"class","s-BO-laqXqKOol"),K(t,X,180,0,5734)},m:function(r,h){ve(r,t,h),O(t,e),Y(s,e,null),O(e,i),Y(n,e,null),O(e,l),O(e,m),O(m,b),O(e,I),O(e,M);for(let f=0;f<S.length;f+=1)S[f]&&S[f].m(M,null);O(M,d),O(M,c),O(e,v),g&&g.m(e,null),O(e,j),_&&_.m(e,null),O(e,L),p&&p.m(e,null),O(e,T),o&&o.m(e,null),a[15](t),W=!0,A||(x=ue(t,"click",a[11],!1,!1,!1,!1),A=!0)},p:function(r,[h]){const f={};if(h&4&&(f.mapInstance=r[2]),n.$set(f),h&1034){R=Me(r[3]);let $;for($=0;$<R.length;$+=1){const F=qe(r,R,$);S[$]?S[$].p(F,h):(S[$]=_e(F),S[$].c(),S[$].m(M,d))}for(;$<S.length;$+=1)S[$].d(1);S.length=R.length}r[4]?g?h&16&&k(g,1):(g=he(r),g.c(),k(g,1),g.m(e,j)):g&&(oe(),y(g,1,1,()=>{g=null}),ne()),r[5]==="submissions"?_?(_.p(r,h),h&32&&k(_,1)):(_=ge(r),_.c(),k(_,1),_.m(e,L)):_&&(oe(),y(_,1,1,()=>{_=null}),ne()),r[5]==="menu"?p?h&32&&k(p,1):(p=pe(r),p.c(),k(p,1),p.m(e,T)):p&&(oe(),y(p,1,1,()=>{p=null}),ne()),r[5]==="tools"?o?h&32&&k(o,1):(o=be(r),o.c(),k(o,1),o.m(e,null)):o&&(oe(),y(o,1,1,()=>{o=null}),ne())},i:function(r){W||(k(s.$$.fragment,r),k(n.$$.fragment,r),k(g),k(_),k(p),k(o),W=!0)},o:function(r){y(s.$$.fragment,r),y(n.$$.fragment,r),y(g),y(_),y(p),y(o),W=!1},d:function(r){r&&V(t),Z(s),Z(n),Ke(S,r),g&&g.d(),_&&_.d(),p&&p.d(),o&&o.d(),a[15](null),A=!1,x()}};return D("SvelteRegisterBlock",{block:w,id:ke.name,type:"component",source:"",ctx:a}),w}function ae(a,t){const e=a%3,s=75,i=50,n=4,l=Math.random()*75,m=Math.random()*75,b=Math.random()>.5?1:-1,q=Math.floor(t/(s+n+m)),I=Math.floor(e/q),M=e%q,d=e*(s+n),c=I*(i+n)+l*b,j=M*(s+n)+m*b+d;return{top:c,left:j}}function nt(a,t,e){let s,i,n,l,m,b,q;N(fe,"initialViewStore"),H(a,fe,o=>e(17,i=o)),N(se,"currentViewStore"),H(a,se,o=>e(18,n=o)),N(re,"mapInstanceStore"),H(a,re,o=>e(2,l=o)),N(ee,"selectedMarkerId"),H(a,ee,o=>e(4,b=o)),N(te,"currentSidebar"),H(a,te,o=>e(5,q=o));let{$$slots:I={},$$scope:M}=t;Ge("Page",I,[]);let d=Be(8);N(d,"zoomLevel"),H(a,d,o=>e(16,s=o));let c,v;Se(()=>{if(c&&e(1,v=c.offsetWidth),l)return;let o;n&&console.log("current view store",n),o=i,map=ie.map("map",{center:[o[0],o[1]],zoom:s}),re.set(map),map.on("zoomend",()=>{d.set(map.getZoom())})});function j(o){const{dir:w}=o.detail;d.update(u=>w==="in"?u<16?u+1:3:w==="out"?u>2?u-1:4:u)}const L=Oe([ye,ce,d],([o,w,u])=>{if(!w||typeof w.contains!="function")return[];const r=o.filter(h=>{const[f,$]=h.latLng;return w.contains(ie.latLng(f,$))});for(let h=r.length-1;h>0;h--){const f=Math.floor(Math.random()*(h+1));[r[h],r[f]]=[r[f],r[h]]}return r.slice(0,u)});N(L,"visibleRandomMarkers"),H(a,L,o=>e(3,m=o));function T(o,w){console.log("calculating bounds",o);const u=parseFloat(o[0]),r=parseFloat(o[1]);return ie.latLngBounds([u-w,r-w],[u+w,r+w])}function W(o){console.log("updating view");const{latLng:w}=o.detail,u=T(w,.1);ce.set(u),se.set({lat:w[0],lng:w[1]})}function A(o){ee.set(o.id)}function x(o){console.log("main click"),!o.target.closest(".sdbbtn")&&!o.target.closest(".sidebar")&&(te.set(null),ee.set(null))}function R(){console.log("closing sidebar"),te.set(null)}const S=[];Object.keys(t).forEach(o=>{!~S.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&tt.warn(`<Page> was created with unknown prop '${o}'`)});function g(o){Xe.call(this,a,o)}const _=o=>A(o);function p(o){De[o?"unshift":"push"](()=>{c=o,e(0,c)})}return a.$capture_state=()=>({onMount:Se,base:Ie,fade:me,writable:Be,derived:Oe,markersStore:ye,mapBoundsStore:ce,selectedMarkerId:ee,currentViewStore:se,mapInstanceStore:re,initialViewStore:fe,currentSidebar:te,Sidebar:Re,SubmissionSidebar:Ve,Search:je,Toolbar:Le,MenuSidebar:Ee,ToolsSidebar:ze,L:ie,latLngBounds:Ye.latLngBounds,menuIconPath:Ze,filterIconPath:xe,zoomLevel:d,mainElement:c,mainWidth:v,getTransformation:ae,updateZoom:j,visibleRandomMarkers:L,calculateBoundsFromSearch:T,handleUpdateView:W,handleImageClick:A,handleMainClick:x,closeSidebar:R,$zoomLevel:s,$initialViewStore:i,$currentViewStore:n,$mapInstanceStore:l,$visibleRandomMarkers:m,$selectedMarkerId:b,$currentSidebar:q}),a.$inject_state=o=>{"zoomLevel"in o&&e(6,d=o.zoomLevel),"mainElement"in o&&e(0,c=o.mainElement),"mainWidth"in o&&e(1,v=o.mainWidth)},t&&"$$inject"in t&&a.$inject_state(t.$$inject),[c,v,l,m,b,q,d,j,L,W,A,x,R,g,_,p]}class ft extends Ne{constructor(t){super(t),He(this,t,nt,ke,Ce,{}),D("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:ke.name})}}export{ft as component,ct as universal};

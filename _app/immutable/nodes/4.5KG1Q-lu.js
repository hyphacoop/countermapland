import{a as Ye,v as J,d as Q,o as Re,e as V,f as P,h as j,j as A,l as D,p as Ze,m as E,q as te,w as pe,x as xe,r as De,y as et,z as tt,A as Ke,n as nt,B as ot,C as at}from"../chunks/scheduler.8doqxhoJ.js";import{S as st,i as lt,d as G,f as Xe,v as it,g as ne,h as oe,b as X,j as b,c as Ve,e as v,m as ae,l as me,t as w,a as B,k as ce,n as se,o as fe,p as rt,q as ct}from"../chunks/index.UaMq7nEC.js";import{g as ft}from"../chunks/object-view.Cuup77aF.js";import{b as Ne}from"../chunks/paths.P1rZr7rA.js";import{S as We,T as Fe,L as he,m as Te,a as ve,f as we,s as re,c as ge,b as be,i as Se,d as ee,e as Ae,g as Ge,M as Ue,h as He,l as ut,j as Je,k as Qe}from"../chunks/ToolsSidebar.Kq2C2cEH.js";import{d as ze,w as Ce}from"../chunks/index.XXZ5sPHA.js";const mt=!1,St=Object.freeze(Object.defineProperty({__proto__:null,ssr:mt},Symbol.toStringTag,{value:"Module"})),{console:dt}=ft,L="src/routes/objects/+page.svelte";function Pe(o,t,e){const l=o.slice();return l[23]=t[e],l[25]=e,l}function Oe(o){let t,e,l,s,n,i,d,S,R;function N(){return o[16](o[23])}const q={c:function(){t=V("div"),e=V("img"),this.h()},l:function(r){t=j(r,"DIV",{class:!0,key:!0,style:!0});var O=A(t);e=j(O,"IMG",{src:!0,alt:!0,style:!0,class:!0}),O.forEach(X),this.h()},h:function(){pe(e.src,l=`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${o[23].photos[0].url}`)||b(e,"src",l),b(e,"alt",s=o[23].photos[0].alt),te(e,"cursor","pointer"),b(e,"class","s-BO-laqXqKOol"),E(e,L,210,8,6649),b(t,"class","image-container s-BO-laqXqKOol"),b(t,"key",o[25]),te(t,"top",ue(o[25],o[1]).top+"px"),te(t,"left",ue(o[25],o[1]).left+"px"),E(t,L,209,6,6489)},m:function(r,O){Ve(r,t,O),v(t,e),d=!0,S||(R=[me(e,"click",ot(o[15]),!1,!1,!0,!1),me(e,"click",N,!1,!1,!1,!1)],S=!0)},p:function(r,O){o=r,(!d||O&16&&!pe(e.src,l=`https://www.veterans.gc.ca/images/remembrance/memorials/national-inventory-canadian-memorials/mem/${o[23].photos[0].url}`))&&b(e,"src",l),(!d||O&16&&s!==(s=o[23].photos[0].alt))&&b(e,"alt",s),(!d||O&2)&&te(t,"top",ue(o[25],o[1]).top+"px"),(!d||O&2)&&te(t,"left",ue(o[25],o[1]).left+"px")},i:function(r){d||(r&&at(()=>{d&&(i&&i.end(1),n=rt(e,we,{duration:300}),n.start())}),d=!0)},o:function(r){n&&n.invalidate(),r&&(i=ct(e,we,{duration:300})),d=!1},d:function(r){r&&X(t),r&&i&&i.end(),S=!1,De(R)}};return G("SvelteRegisterBlock",{block:q,id:Oe.name,type:"if",source:"(209:4) {#if marker.photos && marker.photos.length > 0}",ctx:o}),q}function qe(o){let t,e=o[23].photos&&o[23].photos.length>0&&Oe(o);const l={c:function(){e&&e.c(),t=Ke()},l:function(n){e&&e.l(n),t=Ke()},m:function(n,i){e&&e.m(n,i),Ve(n,t,i)},p:function(n,i){n[23].photos&&n[23].photos.length>0?e?(e.p(n,i),i&16&&w(e,1)):(e=Oe(n),e.c(),w(e,1),e.m(t.parentNode,t)):e&&(fe(),B(e,1,1,()=>{e=null}),ce())},d:function(n){n&&X(t),e&&e.d(n)}};return G("SvelteRegisterBlock",{block:l,id:qe.name,type:"each",source:"(208:4) {#each $visibleRandomMarkers as marker, index}",ctx:o}),l}function Me(o){let t,e;t=new Ae({$$inline:!0});const l={c:function(){ne(t.$$.fragment)},l:function(n){oe(t.$$.fragment,n)},m:function(n,i){ae(t,n,i),e=!0},i:function(n){e||(w(t.$$.fragment,n),e=!0)},o:function(n){B(t.$$.fragment,n),e=!1},d:function(n){se(t,n)}};return G("SvelteRegisterBlock",{block:l,id:Me.name,type:"if",source:"(227:2) {#if $selectedMarkerId}",ctx:o}),l}function $e(o){let t,e;t=new Ge({props:{objectView:!0},$$inline:!0}),t.$on("closeSideBar",o[14]);const l={c:function(){ne(t.$$.fragment)},l:function(n){oe(t.$$.fragment,n)},m:function(n,i){ae(t,n,i),e=!0},p:nt,i:function(n){e||(w(t.$$.fragment,n),e=!0)},o:function(n){B(t.$$.fragment,n),e=!1},d:function(n){se(t,n)}};return G("SvelteRegisterBlock",{block:l,id:$e.name,type:"if",source:"(230:2) {#if $currentSidebar === 'submissions'}",ctx:o}),l}function Be(o){let t,e;t=new Ue({$$inline:!0});const l={c:function(){ne(t.$$.fragment)},l:function(n){oe(t.$$.fragment,n)},m:function(n,i){ae(t,n,i),e=!0},i:function(n){e||(w(t.$$.fragment,n),e=!0)},o:function(n){B(t.$$.fragment,n),e=!1},d:function(n){se(t,n)}};return G("SvelteRegisterBlock",{block:l,id:Be.name,type:"if",source:"(234:0) {#if $currentSidebar === 'menu'}",ctx:o}),l}function ye(o){let t,e;t=new He({$$inline:!0});const l={c:function(){ne(t.$$.fragment)},l:function(n){oe(t.$$.fragment,n)},m:function(n,i){ae(t,n,i),e=!0},i:function(n){e||(w(t.$$.fragment,n),e=!0)},o:function(n){B(t.$$.fragment,n),e=!1},d:function(n){se(t,n)}};return G("SvelteRegisterBlock",{block:l,id:ye.name,type:"if",source:"(238:0) {#if $currentSidebar === 'tools'}",ctx:o}),l}function Ie(o){let t,e,l,s,n,i,d,S,R="*countermap",N,q,g,r,O,W,F,U,Y,I,T,y,le,Z,z,C,de,x,ie,a;l=new We({$$inline:!0}),l.$on("updateView",o[9]),n=new Fe({props:{mapInstance:o[3],objectView:!0},$$inline:!0}),n.$on("zoom",o[7]);let p=Xe(o[4]),c=[];for(let K=0;K<p.length;K+=1)c[K]=qe(Pe(o,p,K));let f=o[5]&&Me(o),u=o[2]==="submissions"&&$e(o),_=o[2]==="menu"&&Be(o),k=o[2]==="tools"&&ye(o);const je={c:function(){t=V("main"),e=V("div"),ne(l.$$.fragment),s=P(),ne(n.$$.fragment),i=P(),d=V("h1"),S=V("a"),S.textContent=R,N=P(),q=V("div");for(let m=0;m<c.length;m+=1)c[m].c();g=P(),r=V("div"),O=P(),f&&f.c(),W=P(),u&&u.c(),F=P(),_&&_.c(),U=P(),k&&k.c(),Y=P(),I=V("div"),T=V("button"),y=V("img"),Z=P(),z=V("button"),C=V("img"),this.h()},l:function(m){t=j(m,"MAIN",{class:!0});var M=A(t);e=j(M,"DIV",{class:!0});var h=A(e);oe(l.$$.fragment,h),s=D(h),oe(n.$$.fragment,h),i=D(h),d=j(h,"H1",{class:!0});var $=A(d);S=j($,"A",{href:!0,class:!0,"data-svelte-h":!0}),Ze(S)!=="svelte-hi9bqo"&&(S.textContent=R),$.forEach(X),N=D(h),q=j(h,"DIV",{class:!0});var H=A(q);for(let ke=0;ke<c.length;ke+=1)c[ke].l(H);g=D(H),r=j(H,"DIV",{id:!0,style:!0}),A(r).forEach(X),H.forEach(X),O=D(h),f&&f.l(h),W=D(h),u&&u.l(h),F=D(h),_&&_.l(h),U=D(h),k&&k.l(h),h.forEach(X),Y=D(M),I=j(M,"DIV",{class:!0});var _e=A(I);T=j(_e,"BUTTON",{class:!0});var Ee=A(T);y=j(Ee,"IMG",{src:!0,alt:!0,class:!0}),Ee.forEach(X),Z=D(_e),z=j(_e,"BUTTON",{class:!0});var Le=A(z);C=j(Le,"IMG",{src:!0,alt:!0,class:!0}),Le.forEach(X),_e.forEach(X),M.forEach(X),this.h()},h:function(){b(S,"href",Ne+"/map"),b(S,"class","s-BO-laqXqKOol"),E(S,L,205,6,6311),b(d,"class","s-BO-laqXqKOol"),E(d,L,205,2,6307),b(r,"id","map"),te(r,"display","none"),E(r,L,224,4,7082),b(q,"class","image-grid s-BO-laqXqKOol"),E(q,L,206,2,6355),b(e,"class","content-container s-BO-laqXqKOol"),E(e,L,202,2,6142),pe(y.src,le=Je)||b(y,"src",le),b(y,"alt","Open Menu Sidebar"),b(y,"class","s-BO-laqXqKOol"),E(y,L,244,2,7519),b(T,"class","menu-button sdbbtn s-BO-laqXqKOol"),E(T,L,243,0,7461),pe(C.src,de=Qe)||b(C,"src",de),b(C,"alt","Open Filter Sidebar"),b(C,"class","s-BO-laqXqKOol"),E(C,L,247,2,7640),b(z,"class","filter-button sdbbtn s-BO-laqXqKOol"),E(z,L,246,0,7579),b(I,"class","buttons-container s-BO-laqXqKOol"),E(I,L,242,0,7429),b(t,"class","s-BO-laqXqKOol"),E(t,L,201,0,6082)},m:function(m,M){Ve(m,t,M),v(t,e),ae(l,e,null),v(e,s),ae(n,e,null),v(e,i),v(e,d),v(d,S),v(e,N),v(e,q);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(q,null);v(q,g),v(q,r),v(e,O),f&&f.m(e,null),v(e,W),u&&u.m(e,null),v(e,F),_&&_.m(e,null),v(e,U),k&&k.m(e,null),v(t,Y),v(t,I),v(I,T),v(T,y),v(I,Z),v(I,z),v(z,C),o[17](t),x=!0,ie||(a=[me(T,"click",o[12],!1,!1,!1,!1),me(z,"click",o[13],!1,!1,!1,!1),me(t,"click",o[11],!1,!1,!1,!1)],ie=!0)},p:function(m,[M]){const h={};if(M&8&&(h.mapInstance=m[3]),n.$set(h),M&1042){p=Xe(m[4]);let $;for($=0;$<p.length;$+=1){const H=Pe(m,p,$);c[$]?c[$].p(H,M):(c[$]=qe(H),c[$].c(),c[$].m(q,g))}for(;$<c.length;$+=1)c[$].d(1);c.length=p.length}m[5]?f?M&32&&w(f,1):(f=Me(m),f.c(),w(f,1),f.m(e,W)):f&&(fe(),B(f,1,1,()=>{f=null}),ce()),m[2]==="submissions"?u?(u.p(m,M),M&4&&w(u,1)):(u=$e(m),u.c(),w(u,1),u.m(e,F)):u&&(fe(),B(u,1,1,()=>{u=null}),ce()),m[2]==="menu"?_?M&4&&w(_,1):(_=Be(m),_.c(),w(_,1),_.m(e,U)):_&&(fe(),B(_,1,1,()=>{_=null}),ce()),m[2]==="tools"?k?M&4&&w(k,1):(k=ye(m),k.c(),w(k,1),k.m(e,null)):k&&(fe(),B(k,1,1,()=>{k=null}),ce())},i:function(m){x||(w(l.$$.fragment,m),w(n.$$.fragment,m),w(f),w(u),w(_),w(k),x=!0)},o:function(m){B(l.$$.fragment,m),B(n.$$.fragment,m),B(f),B(u),B(_),B(k),x=!1},d:function(m){m&&X(t),se(l),se(n),xe(c,m),f&&f.d(),u&&u.d(),_&&_.d(),k&&k.d(),o[17](null),ie=!1,De(a)}};return G("SvelteRegisterBlock",{block:je,id:Ie.name,type:"component",source:"",ctx:o}),je}function ue(o,t){const e=o%3,l=75,s=50,n=4,i=Math.random()*75,d=Math.random()*75,S=Math.random()>.5?1:-1,R=Math.floor(t/(l+n+d)),N=Math.floor(e/R),q=e%R,g=e*(l+n),r=N*(s+n)+i*S,W=q*(l+n)+d*S+g;return{top:r,left:W}}function _t(o,t,e){let l,s,n,i,d,S,R;J(ee,"currentSidebar"),Q(o,ee,a=>e(2,l=a)),J(Se,"initialViewStore"),Q(o,Se,a=>e(19,n=a)),J(ge,"currentViewStore"),Q(o,ge,a=>e(20,i=a)),J(be,"mapInstanceStore"),Q(o,be,a=>e(3,d=a)),J(re,"selectedMarkerId"),Q(o,re,a=>e(5,R=a));let{$$slots:N={},$$scope:q}=t;it("Page",N,[]);let g=Ce(8);J(g,"zoomLevel"),Q(o,g,a=>e(18,s=a));let r,O;Re(()=>{if(r&&e(1,O=r.offsetWidth),d)return;let a;i&&console.log("current view store",i),a=n,map=he.map("map",{center:[a[0],a[1]],zoom:s}),be.set(map),map.on("zoomend",()=>{g.set(map.getZoom())})});function W(a){const{dir:p}=a.detail;g.update(c=>p==="in"?c<16?c+1:3:p==="out"?c>2?c-1:4:c)}const F=ze([Te,ve,g],([a,p,c])=>{if(!p||typeof p.contains!="function")return[];const f=a.filter(u=>{const[_,k]=u.latLng;return p.contains(he.latLng(_,k))});for(let u=f.length-1;u>0;u--){const _=Math.floor(Math.random()*(u+1));[f[u],f[_]]=[f[_],f[u]]}return f.slice(0,c)});J(F,"visibleRandomMarkers"),Q(o,F,a=>e(4,S=a));function U(a,p){console.log("calculating bounds",a);const c=parseFloat(a[0]),f=parseFloat(a[1]);return he.latLngBounds([c-p,f-p],[c+p,f+p])}function Y(a){console.log("updating view");const{latLng:p}=a.detail,c=U(p,.1);ve.set(c),ge.set({lat:p[0],lng:p[1]})}function I(a){re.set(a.id)}function T(a){console.log("main click"),!a.target.closest(".sdbbtn")&&!a.target.closest(".sidebar")&&(ee.set(null),re.set(null))}function y(a){ee.set(a)}function le(){y(l==="menu"?null:"menu")}function Z(){y(l==="tools"?null:"tools")}function z(){console.log("closing sidebar"),ee.set(null)}const C=[];Object.keys(t).forEach(a=>{!~C.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&dt.warn(`<Page> was created with unknown prop '${a}'`)});function de(a){et.call(this,o,a)}const x=a=>I(a);function ie(a){tt[a?"unshift":"push"](()=>{r=a,e(0,r)})}return o.$capture_state=()=>({onMount:Re,base:Ne,fade:we,writable:Ce,derived:ze,markersStore:Te,mapBoundsStore:ve,selectedMarkerId:re,currentViewStore:ge,mapInstanceStore:be,initialViewStore:Se,currentSidebar:ee,Sidebar:Ae,SubmissionSidebar:Ge,Search:We,Toolbar:Fe,MenuSidebar:Ue,ToolsSidebar:He,L:he,latLngBounds:ut.latLngBounds,menuIconPath:Je,filterIconPath:Qe,zoomLevel:g,mainElement:r,mainWidth:O,getTransformation:ue,updateZoom:W,visibleRandomMarkers:F,calculateBoundsFromSearch:U,handleUpdateView:Y,handleImageClick:I,handleMainClick:T,setCurrentSidebar:y,showMenu:le,showTools:Z,closeSidebar:z,$currentSidebar:l,$zoomLevel:s,$initialViewStore:n,$currentViewStore:i,$mapInstanceStore:d,$visibleRandomMarkers:S,$selectedMarkerId:R}),o.$inject_state=a=>{"zoomLevel"in a&&e(6,g=a.zoomLevel),"mainElement"in a&&e(0,r=a.mainElement),"mainWidth"in a&&e(1,O=a.mainWidth)},t&&"$$inject"in t&&o.$inject_state(t.$$inject),[r,O,l,d,S,R,g,W,F,Y,I,T,le,Z,z,de,x,ie]}class wt extends st{constructor(t){super(t),lt(this,t,_t,Ie,Ye,{}),G("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Ie.name})}}export{wt as component,St as universal};
